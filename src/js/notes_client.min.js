var quill=new Quill("#editor",{theme:"snow"});window.currentEvent=0,window.currentTeam=0,document.getElementById("editor").style.display="none";const waitMs=e=>new Promise(t=>setTimeout(t,e));function goToHome(){window.location.href="/"}async function getNote(){eventCode=document.getElementById("eventCode").value,teamNumber=document.getElementById("teamNumber").value,window.currentEvent=eventCode,window.currentTeam=teamNumber,document.getElementById("viewNoteButton").innerHTML="Requesting Data...";let e=new XMLHttpRequest;e.open("GET",`/api/notes/${eventCode}/${teamNumber}/getNotes`,!0),e.withCredentials=!0,e.onreadystatechange=async()=>{if(e.readyState===XMLHttpRequest.DONE&&200===e.status)console.log("200 ok"),console.log(e.responseText),document.getElementById("viewNoteButton").innerHTML="Rendering View...",document.getElementById("searchContainer").style.display="none",document.getElementById("edit").style.display="inherit",document.getElementById("editor").style.display="inherit",document.getElementById("viewNoteButton").innerHTML="View",quill.setContents(JSON.parse(e.responseText));else if(401===e.status)console.log("401 failure"),document.getElementById("viewNoteButton").innerHTML="401 Unauthorized",await waitMs(1e3),window.location.href="/login";else if(400===e.status)console.log("400 failure"),document.getElementById("viewNoteButton").innerHTML="400 Bad Request";else if(500===e.status){if(console.log("500 failure"),document.getElementById("viewNoteButton").innerHTML="500 Internal Server Error","none"==e.responseText){let t=new XMLHttpRequest;t.open("GET",`/api/notes/${eventCode}/${teamNumber}/createNote`,!0),t.withCredentials=!0,t.onreadystatechange=async()=>{t.readyState===XMLHttpRequest.DONE&&200===t.status?getNote():401===t.status?(console.log("401 failure"),document.getElementById("viewNoteButton").innerHTML="401 Unauthorized",await waitMs(1e3),window.location.href="/login"):400===t.status?(console.log("400 failure"),document.getElementById("viewNoteButton").innerHTML="400 Bad Request"):500===t.status?(console.log("500 failure"),document.getElementById("viewNoteButton").innerHTML="500 Internal Server Error"):(console.log("awaiting response"),document.getElementById("viewNoteButton").innerHTML="Downloading Data...")},t.send()}}else if(403===e.status){if("none"==e.responseText){let n=new XMLHttpRequest;n.open("GET",`/api/notes/${eventCode}/${teamNumber}/createNote`,!0),n.withCredentials=!0,n.onreadystatechange=async()=>{n.readyState===XMLHttpRequest.DONE&&200===n.status?getNote():401===n.status?(console.log("401 failure"),document.getElementById("viewNoteButton").innerHTML="401 Unauthorized",await waitMs(1e3),window.location.href="/login"):400===n.status?(console.log("400 failure"),document.getElementById("viewNoteButton").innerHTML="400 Bad Request"):500===n.status?(console.log("500 failure"),document.getElementById("viewNoteButton").innerHTML="500 Internal Server Error"):(console.log("awaiting response"),document.getElementById("viewNoteButton").innerHTML="Downloading Data...")},n.send()}}else console.log("awaiting response"),document.getElementById("viewNoteButton").innerHTML="Downloading Data..."},e.send()}function saveNote(){JSON.toString(quill.getContents()),eventCode=document.getElementById("eventCode").value,teamNumber=document.getElementById("teamNumber").value,document.getElementById("saveNoteButton").innerHTML="Saving Data...";let e=new XMLHttpRequest;e.open("POST",`/api/notes/${eventCode}/${teamNumber}/updateNotes`,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.withCredentials=!0,e.onreadystatechange=async()=>{e.readyState===XMLHttpRequest.DONE&&200===e.status?(console.log("200 ok"),console.log(e.responseText),document.getElementById("saveNoteButton").innerHTML="Rendering View...",document.getElementById("saveNoteButton").innerHTML="Saved!",await waitMs(1e3),document.getElementById("saveNoteButton").innerHTML="Save"):401===e.status?(console.log("401 failure"),document.getElementById("viewNoteButton").innerHTML="401 Unauthorized",await waitMs(1e3),window.location.href="/login"):400===e.status?(console.log("400 failure"),document.getElementById("viewNoteButton").innerHTML="400 Bad Request"):500===e.status?(console.log("500 failure"),document.getElementById("viewNoteButton").innerHTML="500 Internal Server Error"):(console.log("awaiting response"),document.getElementById("viewNoteButton").innerHTML="Downloading Data...")},e.send("save="+JSON.stringify(quill.getContents()))}