var numberInput=document.getElementById("number"),eventCode=document.getElementById("event").value,error=document.getElementById("errorTxt"),searchBtn=document.getElementById("searchBtn");function eV(e){return"true"==e?"✅":"❌"}async function search(){let e=Number(numberInput.value);if(e<1||isNaN(e)){numberInput.style.borderColor="var(--cancelColor)";return}var t,d,r,a,o="";"team"===document.getElementById("type").value?(r=`/api/data/current/team/${eventCode}/${e}`,a="team"):(r=`/api/data/current/match/${eventCode}/${e}`,a="match"),searchBtn.innerText="requesting...";try{if(t=await fetch(r,{method:"GET",credentials:"include",redirect:"follow"}),401===t.status||403===t.status){window.location.href="/login";return}if(204===t.status&&(error.innerText="no results",error.style.display="unset"),d=await t.json(),"team"===a){var g={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0,lowCube:0,lowCone:0,midCube:0,midCone:0,highCube:0,highCone:0,low:0,mid:0,high:0},n={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0},l={auto_charge:Number.MAX_SAFE_INTEGER,teleop_charge:Number.MAX_SAFE_INTEGER,grid:Number.MAX_SAFE_INTEGER,cycle:Number.MAX_SAFE_INTEGER,perf_score:Number.MAX_SAFE_INTEGER};function c(e,t){n[e]<t&&(n[e]=t)}function i(e,t){l[e]>t&&(l[e]=t)}for(var m=0;m<d.length;m++)o+=` <tr><td><a href="/detail?id=${d[m].id}" target="_blank" style="all: unset; color: #2997FF; text-decoration: none;">${d[m].level} ${d[m].match}</a><br><span>${d[m].discordName}#${d[m].discordTag}</span></td><td>${eV(d[m].game2)}${eV(d[m].game3)}${eV(d[m].game4)}</td><td>${d[m].game5}</td><td>${eV(d[m].game6)}${eV(d[m].game7)}${eV(d[m].game8)}</td><td>${d[m].game10}</td><td>${d[m].game25}</td><td>${d[m].game21}</td><td>${d[m].game14}</td><td>${d[m].game16}</td><td>${d[m].game13}</td><td>${d[m].game15}</td><td>${d[m].game17}</td><td>${d[m].game18}</td><td>${d[m].game19}</td><td>${d[m].game20}</td><td>${d[m].game11}</td><td>${Number(d[m].weight.split(",")[0]).toFixed(2)}</td></tr>`,g.auto_charge+=Number(d[m].game5),g.teleop_charge+=Number(d[m].game10),g.grid+=Number(d[m].game25),g.cycle+=Number(d[m].game11),g.perf_score+=Number(d[m].weight.split(",")[0]),g.lowCube+=Number(d[m].game21),g.lowCone+=Number(d[m].game13),g.midCube+=Number(d[m].game14),g.midCone+=Number(d[m].game15),g.highCube+=Number(d[m].game16),g.highCone+=Number(d[m].game17),g.low+=Number(d[m].game18),g.mid+=Number(d[m].game19),g.high+=Number(d[m].game20),c("auto_charge",d[m].game5),c("teleop_charge",d[m].game10),c("grid",d[m].game25),c("cycle",d[m].game11),c("perf_score",Number(d[m].weight.split(",")[0])),i("auto_charge",d[m].game5),i("teleop_charge",d[m].game10),i("grid",d[m].game25),i("cycle",d[m].game11),i("perf_score",Number(d[m].weight.split(",")[0]));for(let u in g)g[u]/=d.length;for(let s in l)l[s]===Number.MAX_SAFE_INTEGER&&(l[s]="und");o+=`<tr style="font-weight: bold"><td>avg</td><td></td><td>${Math.round(g.auto_charge)} (${l.auto_charge} - ${n.auto_charge})</td><td></td><td>${Math.round(g.teleop_charge)} (${l.teleop_charge} - ${n.teleop_charge})</td><td>${Math.round(g.grid)} (${l.grid} - ${n.grid})</td><td>${Math.round(g.lowCube)}</td><td>${Math.round(g.midCube)}</td><td>${Math.round(g.highCube)}</td><td>${Math.round(g.lowCone)}</td><td>${Math.round(g.midCone)}</td><td>${Math.round(g.highCone)}</td><td>${Math.round(g.low)}</td><td>${Math.round(g.mid)}</td><td>${Math.round(g.high)}</td><td>${Math.round(g.cycle)} (${l.cycle} - ${n.cycle})</td><td>${g.perf_score.toFixed(2)} (${l.perf_score.toFixed(2)} - ${n.perf_score.toFixed(2)})</td></tr>`}else{for(var g={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0},m=0;m<d.length;m++)o+=` <tr><td><strong>Team ${d[m].team}</strong><br><a href="/detail?id=${d[m].id}" target="_blank" style="all: unset; color: #2997FF; text-decoration: none;">${d[m].level} ${d[m].match}</a><br><span>${d[m].discordName}#${d[m].discordTag}</span></td><td>${eV(d[m].game2)}${eV(d[m].game3)}${eV(d[m].game4)}</td><td>${d[m].game5}</td><td>${eV(d[m].game6)}${eV(d[m].game7)}${eV(d[m].game8)}</td><td>${d[m].game10}</td><td>${d[m].game25}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>${d[m].game11}</td><td>${Number(d[m].weight.split(",")[0]).toFixed(2)}</td></tr>`,g.auto_charge+=Number(d[m].game5),g.teleop_charge+=Number(d[m].game10),g.grid+=Number(d[m].game25),g.cycle+=Number(d[m].game11),g.perf_score+=Number(d[m].weight.split(",")[0]);for(let h in g)g[h]/=d.length;o+=`<tr><td>avg</td><td></td><td>${Math.round(g.auto_charge)}</td><td></td><td>${Math.round(g.teleop_charge)}</td><td>${Math.round(g.grid)}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>${Math.round(g.cycle)}</td><td>${g.perf_score.toFixed(2)}</td></tr>`}document.getElementById("subheadings").insertAdjacentHTML("afterend",o),document.getElementById("search").style.display="none",document.getElementById("results").style.display="flex"}catch(p){searchBtn.innerText="error",error.innerText="no results",error.style.display="unset",console.error(p)}}function goToHome(){window.location.href="/"}document.getElementById("number").onkeyup=e=>{""!==e.target.value&&(document.getElementById("number").style.borderColor="var(--defaultInputColor)")};