import{_get as e}from"../_modules/get/get.min.js";var numberInput=document.getElementById("number"),eventCode=document.getElementById("event"),error=document.getElementById("errorTxt"),searchBtn=document.getElementById("searchBtn");function eV(e){return"true"==e?"✅":"❌"}function callSearch(){search(Number(numberInput.value),eventCode.value,document.getElementById("type").value)}function generateSmallAvgRow(e){return`<tr><td>avg</td><td></td><td>${Math.round(e.auto_charge)}</td><td></td><td>${Math.round(e.teleop_charge)}</td><td>${Math.round(e.grid)}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>${Math.round(e.cycle)}</td><td>${e.perf_score.toFixed(2)}</td></tr>`}async function search(t,d,a="team"){if(t<0||isNaN(t)){numberInput.style.borderColor="var(--cancelColor)";return}var r,g,n="";"team"===a?(r=`/api/data/current/team/${d}/${t}`,g="team"):(r=`/api/data/current/match/${d}/${t}`,g="match"),searchBtn.innerText="requesting...",e(r,searchBtn.id).then(e=>{if("team"===g){let t={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0,lowCube:0,lowCone:0,midCube:0,midCone:0,highCube:0,highCone:0,low:0,mid:0,high:0},d={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0},a={auto_charge:Number.MAX_SAFE_INTEGER,teleop_charge:Number.MAX_SAFE_INTEGER,grid:Number.MAX_SAFE_INTEGER,cycle:Number.MAX_SAFE_INTEGER,perf_score:Number.MAX_SAFE_INTEGER};function r(e,t){d[e]<t&&(d[e]=t)}function o(e,t){a[e]>t&&(a[e]=t)}for(var l=0;l<e.length;l++)n+=` <tr><td><a href="/detail?id=${e[l].id}" target="_blank" style="all: unset; color: #2997FF; text-decoration: none;">${e[l].level} ${e[l].match}</a><br><span>${e[l].name} (${e[l].fromTeam})</span></td><td>${eV(e[l].game2)}${eV(e[l].game3)}${eV(e[l].game4)}</td><td>${e[l].game5}</td><td>${eV(e[l].game6)}${eV(e[l].game7)}${eV(e[l].game8)}</td><td>${e[l].game10}</td><td>${e[l].game25}</td><td>${e[l].game21}</td><td>${e[l].game14}</td><td>${e[l].game16}</td><td>${e[l].game13}</td><td>${e[l].game15}</td><td>${e[l].game17}</td><td>${e[l].game18}</td><td>${e[l].game19}</td><td>${e[l].game20}</td><td>${e[l].game11}</td><td>${Number(e[l].weight.split(",")[0]).toFixed(2)}</td></tr>`,t.auto_charge+=Number(e[l].game5),t.teleop_charge+=Number(e[l].game10),t.grid+=Number(e[l].game25),t.cycle+=Number(e[l].game11),t.perf_score+=Number(e[l].weight.split(",")[0]),t.lowCube+=Number(e[l].game21),t.lowCone+=Number(e[l].game13),t.midCube+=Number(e[l].game14),t.midCone+=Number(e[l].game15),t.highCube+=Number(e[l].game16),t.highCone+=Number(e[l].game17),t.low+=Number(e[l].game18),t.mid+=Number(e[l].game19),t.high+=Number(e[l].game20),r("auto_charge",Number(e[l].game5)),r("teleop_charge",Number(e[l].game10)),r("grid",Number(e[l].game25)),r("cycle",Number(e[l].game11)),r("perf_score",Number(e[l].weight.split(",")[0])),o("auto_charge",Number(e[l].game5)),o("teleop_charge",Number(e[l].game10)),o("grid",Number(e[l].game25)),o("cycle",Number(e[l].game11)),o("perf_score",Number(e[l].weight.split(",")[0]));for(let m in t)t[m]/=e.length;for(let c in a)a[c]===Number.MAX_SAFE_INTEGER&&(a[c]="und");n+=`<tr style="font-weight: bold"><td>avg</td><td></td><td>${Math.round(t.auto_charge)} (${a.auto_charge} - ${d.auto_charge})</td><td></td><td>${Math.round(t.teleop_charge)} (${a.teleop_charge} - ${d.teleop_charge})</td><td>${Math.round(t.grid)} (${a.grid} - ${d.grid})</td><td>${Math.round(t.lowCube)}</td><td>${Math.round(t.midCube)}</td><td>${Math.round(t.highCube)}</td><td>${Math.round(t.lowCone)}</td><td>${Math.round(t.midCone)}</td><td>${Math.round(t.highCone)}</td><td>${Math.round(t.low)}</td><td>${Math.round(t.mid)}</td><td>${Math.round(t.high)}</td><td>${Math.round(t.cycle)} (${a.cycle} - ${d.cycle})</td><td>${t.perf_score.toFixed(2)} (${a.perf_score.toFixed(2)} - ${d.perf_score.toFixed(2)})</td></tr>`}else{let i={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0};for(var l=0;l<e.length;l++)n+=` <tr><td><strong>Team ${e[l].team}</strong><br><a href="/detail?id=${e[l].id}" target="_blank" style="all: unset; color: #2997FF; text-decoration: none;">${e[l].level} ${e[l].match}</a><br><span>${e[l].name} (${e[l].team})</span></td><td>${eV(e[l].game2)}${eV(e[l].game3)}${eV(e[l].game4)}</td><td>${e[l].game5}</td><td>${eV(e[l].game6)}${eV(e[l].game7)}${eV(e[l].game8)}</td><td>${e[l].game10}</td><td>${e[l].game25}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>${e[l].game11}</td><td>${Number(e[l].weight.split(",")[0]).toFixed(2)}</td></tr>`,i.auto_charge+=Number(e[l].game5),i.teleop_charge+=Number(e[l].game10),i.grid+=Number(e[l].game25),i.cycle+=Number(e[l].game11),i.perf_score+=Number(e[l].weight.split(",")[0]);for(let h in i)i[h]/=e.length;n+=generateSmallAvgRow(i)}document.getElementById("subheadings").insertAdjacentHTML("afterend",n),document.getElementById("search").style.display="none",document.getElementById("results").style.display="flex"}).catch(e=>console.log(e))}async function searchOnLoad(){let t=new URLSearchParams(window.location.search),d=t.get("userId");d?e(`/api/data/current/scout/${d}`,error.id).then(e=>{for(var t={auto_charge:0,teleop_charge:0,grid:0,cycle:0,perf_score:0},d="",a=0;a<e.length;a++)d+=` <tr><td><strong>Team ${e[a].team}</strong><br><a href="/detail?id=${e[a].id}" target="_blank" style="all: unset; color: #2997FF; text-decoration: none;">${e[a].level} ${e[a].match}</a></td><td>${eV(e[a].game2)}${eV(e[a].game3)}${eV(e[a].game4)}</td><td>${e[a].game5}</td><td>${eV(e[a].game6)}${eV(e[a].game7)}${eV(e[a].game8)}</td><td>${e[a].game10}</td><td>${e[a].game25}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>${e[a].game11}</td><td>${Number(e[a].weight.split(",")[0]).toFixed(2)}</td></tr>`,t.auto_charge+=Number(e[a].game5),t.teleop_charge+=Number(e[a].game10),t.grid+=Number(e[a].game25),t.cycle+=Number(e[a].game11),t.perf_score+=Number(e[a].weight.split(",")[0]);for(let r in t)t[r]/=e.length;d+=generateSmallAvgRow(t),document.getElementById("subheadings").insertAdjacentHTML("afterend",d),document.getElementById("search").style.display="none",document.getElementById("results").style.display="flex"}).catch(e=>console.log(e)):t.get("number")&&t.get("event")&&t.get("type")&&search(Number(t.get("number")),t.get("event"),t.get("type"))}window.searchOnLoad=searchOnLoad,window.search=search,document.getElementById("number").addEventListener("keyup",e=>{""!==e.target.value&&(document.getElementById("number").style.borderColor="var(--defaultInputColor)")}),window.addEventListener("keydown",e=>{"Enter"===e.key&&"none"===document.getElementById("results").style.display&&callSearch()});