const elemBegin=document.getElementById("createPk"),elemSuccess=document.getElementById("success"),elemError=document.getElementById("error");elemBegin.addEventListener("click",async()=>{elemSuccess.innerHTML="",elemError.innerHTML="";let e=await fetch("/api/auth/createPasskey"),r;try{r=await SimpleWebAuthnBrowser.startRegistration(await e.json())}catch(t){throw"InvalidStateError"===t.name?elemError.innerText="Error: Authenticator was probably already registered by user":elemError.innerText=t,t}let a=await fetch("/api/auth/verifyPasskey",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=await a.json();n&&n.verified?elemSuccess.innerHTML="success":elemSuccess.innerHTML=`error<br><br><pre>${JSON.stringify(n)}</pre>`});