const elemBegin=document.getElementById("createPk"),elemSuccess=document.getElementById("success"),elemError=document.getElementById("error");elemBegin.addEventListener("click",async()=>{elemSuccess.innerHTML="",elemError.innerHTML="";let e=await fetch("/api/auth/createPasskey"),r;try{r=await SimpleWebAuthnBrowser.startRegistration(await e.json())}catch(t){throw"InvalidStateError"===t.name?elemError.innerText="you probably already registered this authenticator":elemError.innerText=t,t}let s=await fetch("/api/auth/verifyPasskey",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();a&&a.verified?(elemSuccess.innerHTML="success",alert("passkey successfully registered")):elemSuccess.innerHTML=`error<br><br><pre>${JSON.stringify(a)}</pre>`});