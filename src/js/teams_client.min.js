function addProperty(e,t,n){void 0!==e[t]?e[t].push(n):(e[t]=[],addProperty(e,t,n))}const waitMs=e=>new Promise(t=>setTimeout(t,e));function goToHome(){window.location.href="/"}function decayingValue(e){return 5/(1.25*e+2.5)}function decayArray(e){for(var t=[],n=e-1;n>=0;n--)t.push(decayingValue(n));return t}async function getTeamRanks(){let e=document.getElementById("eventCode").value,t=Number(document.getElementById("weightType").value);document.getElementById("viewTeamsButton").innerText="Requesting Data...";let n=new XMLHttpRequest;n.open("GET",`/api/teams/current/${e}`,!0),n.withCredentials=!0,n.onreadystatechange=async()=>{if(n.readyState===XMLHttpRequest.DONE&&200===n.status){document.getElementById("viewTeamsButton").innerText="Rendering View...";var r=JSON.parse(n.responseText),a={};for(let s in r.forEach(e=>{addProperty(a,e.team,Number(e.weight.split(",")[Number(t)]))}),console.log(a),a){let d=decayArray(s.length);for(let o=0;o<s.length;o++)s[o]*=d[o];s=s.reduce((e,t)=>e+t,0)/d.reduce((e,t)=>e+t,0)}var i="";Object.entries(a).sort((e,t)=>t[1]-e[1]).forEach((t,n,r)=>{i+=`<tr><td>${n+1}</td><td><a href="/browse?number=${t[0]}&type=team&event=${e}" style="all: unset; color: #2997FF; text-decoration: none;">${t[0]}</a></td><td>${Math.round(t[1])}%</td><td><progress id="scoreWt" max="${r[0][1]}" value="${Math.round(t[1])}"></progress></td>`}),document.getElementById("preInsert").insertAdjacentHTML("afterend",i),document.getElementById("search").style.display="none",document.getElementById("results").style.display="flex",document.getElementById("eventCodeDisplay").innerHTML=`Top teams at ${e}<br>${document.getElementById("weightType").selectedOptions[0].innerText}`,document.getElementById("viewTeamsButton").innerText="View"}else 401===n.status||403===n.status?window.location.href="/login":400===n.status?document.getElementById("viewTeamsButton").innerText="bad request":500===n.status?document.getElementById("viewTeamsButton").innerText="internal server error":502===n.status?document.getElementById("viewTeamsButton").innerText="server error: bad gateway":document.getElementById("viewTeamsButton").innerText="downloading data..."},n.send()}