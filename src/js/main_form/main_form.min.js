var eventMatches,matchesOk=!1;async function loadMatches(){try{let e=await fetch(`/api/matches/current/${document.getElementById("eventCode").value}/qual/all`,{method:"GET",credentials:"include",redirect:"follow"});if(401===e.status||403===e.status)return window.location.href="/login";if(204===e.status||!e.ok){document.getElementById("badEvent").innerHTML="&emsp;no results",document.getElementById("badEvent").style.display="unset",matchesOk=!1;return}eventMatches=await e.json(),matchesOk=!0,document.getElementById("badEvent").style.display="none",matchNumberChange({target:document.getElementById("matchNumberInput")})}catch(t){document.getElementById("badEvent").innerHTML="&emsp;no results",document.getElementById("badEvent").style.display="unset",matchesOk=!1}}async function checkLogin(){try{var e=await fetch("/api/whoami",{method:"GET",credentials:"include",redirect:"follow"});(401===e.status||403===e.status)&&(window.location.href="/login")}catch(t){console.log("failure"),window.location.href="/login"}}function setOption(e,t){e.value=String(t),e.innerText=String(t)}function matchNumberChange(e){if(matchesOk){let t=document.getElementById("badMatchNum");if(Number(e.target.value)>0&&Number(e.target.value)<=eventMatches.Schedule.length){t.style.display="none",document.getElementById("submitButton").removeAttribute("disabled");let a=eventMatches.Schedule[Number(e.target.value)-1].teams,n=Array.from(document.getElementsByClassName("teamNumOption"));setOption(n[3],a[0].teamNumber),setOption(n[4],a[1].teamNumber),setOption(n[5],a[2].teamNumber),setOption(n[0],a[3].teamNumber),setOption(n[1],a[4].teamNumber),setOption(n[2],a[5].teamNumber)}else t.innerHTML="&emsp;match number must be between 1 and "+eventMatches.Schedule.length,t.style.display="unset",document.getElementById("submitButton").setAttribute("disabled","disabled")}else window.setTimeout(e=>{matchNumberChange(e)},1e3),document.getElementById("submitButton").setAttribute("disabled","disabled")}function validateLengthFn(){let e=document.getElementById("validateLength").value;120>=Number(e)&&Number(e)>=0?(document.getElementById("tooLong").style.display="none",document.getElementById("submitButton").removeAttribute("disabled")):(document.getElementById("tooLong").style.display="inherit",document.getElementById("submitButton").setAttribute("disabled","disabled"))}function requiredFormFields(e){String(e.target.value).length>0?document.getElementById("submitButton").removeAttribute("disabled"):document.getElementById("submitButton").setAttribute("disabled","disabled")}function getAllCells(){var e=[];for(let t=1;t<4;t++)for(let a=1;a<10;a++)e.push(document.getElementById("sgc_"+t+"_"+a));return e}loadMatches(),validateLengthFn(),document.getElementById("eventCode").addEventListener("change",async()=>{await loadMatches()}),document.getElementById("matchNumberInput").addEventListener("input",e=>{matchNumberChange(e)}),document.getElementById("validateLength").addEventListener("input",()=>{validateLengthFn()}),Array.from(document.querySelectorAll("[required]")).forEach(e=>{e.addEventListener("input",e=>{requiredFormFields(e)})}),window.innerHeight>window.innerWidth&&(document.getElementById("landscapeReminder").style.display="inline"),window.addEventListener("resize",function(){window.innerHeight>window.innerWidth?document.getElementById("landscapeReminder").style.display="inline":document.getElementById("landscapeReminder").style.display="none"});var sgCellStatus=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];const allCells=getAllCells();function processCellClick(e,t){sgCellStatus[Number(e)]=t,document.getElementById("griddata").value=sgCellStatus.join(""),console.log(document.getElementById("griddata").value)}function setGray(e){e.innerText="","true"==e.getAttribute("data-coop")?e.style.background="#bbb":e.style.background="#ddd",e.setAttribute("data-state","0"),processCellClick(e.getAttribute("data-num"),0)}function setSingleCube(e){e.style.background="#a216a2",e.innerText="",e.setAttribute("data-state","1"),processCellClick(e.getAttribute("data-num"),1)}function setSingleCone(e){e.style.background="#ff0",e.innerText="",e.setAttribute("data-state","2"),processCellClick(e.getAttribute("data-num"),2)}function setDoubleCube(e){e.style.background="#a216a2",e.style.color="#ff0",e.innerText="2",e.setAttribute("data-state","3"),processCellClick(e.getAttribute("data-num"),3)}function setDoubleCone(e){e.style.background="#ff0",e.style.color="#a216a2",e.innerText="2",e.setAttribute("data-state","5"),processCellClick(e.getAttribute("data-num"),4)}for(var i=0;i<allCells.length;i+=1)allCells[i].addEventListener("click",function(){"cube"===this.getAttribute("data-gp")?"0"===this.getAttribute("data-state")?setSingleCube(this):"1"===this.getAttribute("data-state")?setDoubleCube(this):setGray(this):"cone"===this.getAttribute("data-gp")?"0"===this.getAttribute("data-state")?setSingleCone(this):"2"===this.getAttribute("data-state")?setDoubleCone(this):setGray(this):"h"===this.getAttribute("data-gp")&&("1"===this.getAttribute("data-state")?setSingleCone(this):"0"===this.getAttribute("data-state")?setSingleCube(this):"3"===this.getAttribute("data-state")?setDoubleCone(this):"2"===this.getAttribute("data-state")?setDoubleCube(this):setGray(this))});async function post(e,t){let a=await fetch(e,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},redirect:"follow",body:JSON.stringify(t)});return a.json()}async function uploadForm(){let e={event:document.getElementsByName("event")[0].value,match:Number(document.getElementsByName("match")[0].value),level:document.getElementsByName("level")[0].value,team:Number(document.getElementsByName("team")[0].value),game1:document.getElementsByName("game1")[0].value,game2:document.getElementsByName("game2")[0].value,game3:document.getElementsByName("game3")[0].value,game4:document.getElementsByName("game4")[0].value,game5:document.getElementsByName("game5")[0].value,game6:document.getElementsByName("game6")[0].value,game7:document.getElementsByName("game7")[0].value,game8:document.getElementsByName("game8")[0].value,game9:document.getElementsByName("game9")[0].value,game10:Number(document.getElementsByName("game10")[0].value),game11:document.getElementsByName("game11")[0].value,game12:document.getElementsByName("game12")[0].value,game13:Number(document.getElementsByName("game13")[0].value),game14:Number(document.getElementsByName("game14")[0].value),game15:Number(document.getElementsByName("game15")[0].value),game16:Number(document.getElementsByName("game16")[0].value),game17:Number(document.getElementsByName("game17")[0].value),game18:Number(document.getElementsByName("game18")[0].value),game19:Number(document.getElementsByName("game19")[0].value),game20:Number(document.getElementsByName("game20")[0].value),game21:Number(document.getElementsByName("game21")[0].value),game22:Number(document.getElementsByName("game22")[0].value),game23:Number(document.getElementsByName("game23")[0].value),game24:Number(document.getElementsByName("game24")[0].value),game25:Number(document.getElementsByName("game25")[0].value),defend:document.getElementsByName("defend")[0].value,driving:document.getElementsByName("driving")[0].value,overall:document.getElementsByName("overall")[0].value};document.getElementById("mainFormHTML").style.display="none",document.getElementById("submitUi").style.display="unset",document.getElementById("reSubmitButton").style.display="none",await new Promise(e=>setTimeout(e,250)),post("/submit",e).then(async t=>{let a=t;console.log(a.id),document.getElementById("submitText_d").innerText="Verifying...",await new Promise(e=>setTimeout(e,250));try{let n=await fetch(`/api/data/exists/${a.id}`,{method:"GET",cache:"no-cache",credentials:"include",redirect:"follow"});(401===n.status||403===n.status)&&(window.location.href="/login");let l=await n.json();l.team==e.team&&l.match==e.match?(document.getElementById("submitText_d").innerText="Done!",document.getElementById("submitProgress_d").value=100,document.getElementById("submitProgress_d").max=100,await new Promise(e=>setTimeout(e,1500)),window.location.href="/"):(document.getElementById("submitText_d").innerText="Possible Error",document.getElementById("submitProgress_d").value=0,document.getElementById("reSubmitButton").style.display="unset")}catch(s){console.log("failure"),window.location.href="/login"}}).catch(e=>{document.getElementById("submitText_d").innerText="ERROR!!!",document.getElementById("submitProgress_d").value=0,document.getElementById("reSubmitButton").style.display="unset",console.error(e)})}