var blackjackSocket,__awaiter=this&&this.__awaiter||function(e,t,a,l){return new(a||(a=Promise))(function(n,o){function s(e){try{d(l.next(e))}catch(t){o(t)}}function i(e){try{d(l.throw(e))}catch(t){o(t)}}function d(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(s,i)}d((l=l.apply(e,t||[])).next())})};function goToHome(){window.location.href="/points"}const x=Math.min(document.documentElement.clientWidth/85,document.documentElement.clientHeight/125),styleSheet=`<style>.bjContainer{margin:0;padding:0;}.bjContainer{display:flex;flex-direction:column;align-items:center;justify-content:center;position:fixed;left:-17.5vw;}.blackjack{image-rendering:pixelated;}.cardImg,.handImg{height:${64*x}px;position:fixed;filter:drop-shadow(0 0 ${2*x}px #000);}.bjBtn{height:${20*x}px;position:fixed;filter:drop-shadow(0 0 ${2*x}px #000)}.dealer1{top:0;left:${5*x}px;}.dealer2{top:0;left:${15*x}px;}.dealer3{top:0;left:${25*x}px;}.dealer4{top:0;left:${35*x}px;}.dealer5{top:0;left:${45*x}px;}.dealer6{top:0;left:${55*x}px;}.dealer7{top:0;left:${65*x}px;}.player1{top:${50*x}px;left:${5*x}px;}.player2{top:${50*x}px;left:${15*x}px;}.player3{top:${50*x}px;left:${25*x}px;}.player4{top:${50*x}px;left:${35*x}px;}.player5{top:${50*x}px;left:${45*x}px;}.player6{top:${50*x}px;left:${55*x}px;}.player7{top:${50*x}px;left:${65*x}px;}.deal{top:${102*x}px;left:${-22*x}px;}.hit{top:${102*x}px;left:${-2*x}px;}.stand{top:${102*x}px;left:${18*x}px;}.deal.noDeal{display:none;}.hit.noDeal{top:${102*x}px;left:${46*x}px;}.stand.noDeal{top:${102*x}px;left:${18*x}px;}</style>`;function startBlackjack(){(blackjackSocket=new WebSocket("wss://beartracks.io/api/casino/blackjack/blackjackSocket")).addEventListener("open",()=>{console.info("blackjack socket opened")}),blackjackSocket.addEventListener("close",()=>{console.info("blackjack socket closed")}),blackjackSocket.onmessage=e=>__awaiter(this,void 0,void 0,function*(){let t=JSON.parse(e.data);if(t.status)144===t.status?(console.info("balance too low"),alert("balance too low to gamble")):145===t.status&&(console.info("balance ok"),setupBoard());else if(t.card){console.info("new card");var a=document.getElementById("deck");drawCard(`${null==a.value?"stdcards":a.value}card-${t.card.suit}_${t.card.value}.png`,t.target),window.disableInputs=!1}else if(t.result)switch(console.info("game over"),t.result){case"WN":playSound("win"),yield waitMs(2e3),alert("you win");break;case"LS":playSound("loss"),yield waitMs(2e3),alert("you lose");break;case"LB":playSound("loss"),yield waitMs(2e3),alert("you lose (bust)");break;case"WD":playSound("win"),yield waitMs(2e3),alert("you win (dealer bust)");break;case"DR":playSound("tie"),yield waitMs(2e3),alert("tie");break;default:alert("unknown error")}})}function setupBoard(){document.getElementById("start").style.display="none",document.getElementById("game").style.display="inline",document.getElementsByClassName("dealer1")[0].src=`${document.getElementById("deck").value}card_back.png`,document.getElementsByClassName("dealer2")[0].src=`${document.getElementById("deck").value}card_back.png`,document.getElementsByClassName("player1")[0].src=`${document.getElementById("deck").value}card_back.png`,document.getElementsByClassName("player2")[0].src=`${document.getElementById("deck").value}card_back.png`,"assets/gruvcards/"===document.getElementById("deck").value&&document.body.classList.add("gruvboxBlackjack")}function drawCard(e,t){document.getElementsByClassName(t)[0].src=e}function playSound(e){new Audio("assets/sounds/min/"+e+"_"+("tie"===e?Math.floor(6*Math.random()):Math.floor(12*Math.random()))+".min.mp3").play()}document.head.insertAdjacentHTML("afterbegin",styleSheet),window.disableInputs=!1,document.getElementsByClassName("hit")[0].onclick=()=>{window.disableInputs?console.info("buttons disabled"):(console.info("hitting..."),blackjackSocket.send("48"),window.disableInputs=!0)},document.getElementsByClassName("stand")[0].onclick=()=>{window.disableInputs?console.info("buttons disabled"):(console.info("standing..."),blackjackSocket.send("49"),window.disableInputs=!0)};